CREATE TABLE USER {
	UserID: 		Integer NOT NULL,
	Name: 			Char(30) NOT NULL,
	DateJoined: 	        Long NOT NULL,
	Age:			Integer NOT NULL,
        Gender:                 Char(1) NOT NULL,
        Preference:             Char(1) NOT NULL,

	Primary Key(UserID)
};

CREATE TABLE SuccessfulMatch {
        UserID1:		Integer NOT NULL,
        UserID2:		Integer NOT NULL,

        Primary Key(UserID1, UserID2),
        Foreign Key(UserID1) references User(UserID),
        Foreign Key(UserID2) references User(UserID),
        Check (UserID1 < UserID2)
};

CREATE TABLE UnsuccessfulMatch {
        UserID1:		Integer NOT NULL,
        UserID2:		Integer NOT NULL,

        Primary Key(UserID1, UserID2),
        Foreign Key(UserID1) references User(UserID),
        Foreign Key(UserID2) references User(UserID),
        Check (UserID1 < UserID2)
};

CREATE TABLE Image {
        UserID:                 Integer NOT NULL,
	DateAdded:             Long NOT NULL,
	ImageURL:		Char(2083) NOT NULL,
	DisplayOrder:	        Integer NOT NULL,

	Primary Key(UserID),
	Foreign Key(UserID) references Users(UserID)
};

CREATE TABLE Message {
	MessageID:		Integer NOT NULL,
	SenderUserID:		Integer NOT NULL,
        ReceiverUserID:		Integer NOT NULL,
	MessageChar():	        Char(20000) NOT NULL,
	SendTime:		Long NOT NULL,

        if (SenderUserID < ReceiverUserID)
                Foreign Key (SenderUserId, ReceiverUserID) references SuccessfulMatch(UserID1, UserID2)
        else
                Foreign Key (ReceiverUserID, SenderUserID) references SuccessfulMatch(UserID1, UserID2)
        end if;
        
	Primary Key(MessageID)
};

CREATE TABLE Business {
	BusinessName:		Char(30) NOT NULL,
	Location		Char(50),

	Primary Key(BusinessID)
};

CREATE TABLE Interest {
	InterestType: Char(20) NOT NULL,
        
        Primary Key(InterestType)
};

CREATE TABLE ActivityBusiness {
        Activity:		Char(50) NOT NULL,
        BusinessName:		Char(30) NOT NULL,

	Primary Key(Activity, BusinessID),
	Foreign Key(BusinessID) references Business
};

CREATE TABLE ActivityInterest {
        Activity:		Char(50) NOT NULL,
        InterestType:	        Char(20) NOT NULL,
        
        Primary Key(Activity),
        Foreign Key(Activity) references ActivityBusiness(Activity),
        Foreign Key(InterestType) references Interest(InterestType)
};

CREATE TABLE ActivityTime {
        Activity:               Char(50) NOT NULL,
        BusinessName:           Char(30) NOT NULL,
        Time:                   Char(5) NOT NULL,
        DateLocation:           Char(50) NOT NULL,
        Discount:               Integer,
        
        Primary Key(Activity, BusinessName, Time, DateLocation),
        Foreign Key(Activity, BusinessName) references ActivityBusiness(Activity, BusinessID)
};

CREATE TABLE InterestedIn {
        UserID:                 Integer NOT NULL,
        Interest:               Char(20) NOT NULL,
        
        Primary Key(UserID, Interest),
        Foreign Key(UserID) references User(UserID),
        Foreign Key(Interest) references Interest(InterestType)
};

CREATE TABLE SuggestedDate {
        UserID1:                Integer NOT NULL,
        UserID2:                Integer NOT NULL,
        Activity:               Char(50) NOT NULL,
        
        Primary Key(UserID1, UserID2),
        Foreign Key(UserID1, UserID2) references SuccessfulMatch(UserID1, UserID2)
};
